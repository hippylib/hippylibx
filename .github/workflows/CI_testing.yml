name: CI
on:
  push:
    branches:
      - numpy_debug_v2
  pull_request:

defaults:
  run:
    shell: bash -l {0}

jobs:
  style:
    runs-on: ubuntu-22.04
    container:
      image: dolfinx/dolfinx:stable
      options: --user 1001 --privileged 
    name: CI test

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: run serial check
        run: mpirun -n 1 python3 testing_suite_file.py 

      # - name: run serial check
      #   run: |
      #     cd ./hippylibX/test && 
      #     output=$(mpirun -n 1 python3 testing_suite_file.py) &&
      #     if [[ "$output" == "1"  ]]; then
      #       exit 1
      #     fi

      # - name: run parallel check
      #   run: |
      #     cd ./hippylibX/test && 
      #     output=$(mpirun -n 2 python3 testing_suite_file.py) &&
      #     if [[ "$output" == "1"  ]]; then
      #       exit 1
      #     fi


